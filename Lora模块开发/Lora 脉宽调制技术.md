### 简介
LoRa是一种专有的扩频调制方案，它是Chirp扩频调制(CSS)的衍生物，在固定信道带宽内以数据速率换取灵敏度。它实现了可变数据速率，利用正交扩频因子，允许系统设计者以数据速率换取距离或功率，从而在恒定带宽下优化网络性能,。
Lora是smetech 专利的一种扩频调制技术，通过牺牲数据传输速率来换取长通信距离以及低发射功率，同事放宽了对晶体振荡器和RC震荡器的要求，适用于传输速率低（低于1kpbs) ,传输距离远（不可视传播距离可达3Km),低功率的应用场景。（野外只能使用电池供电的场景）。
### 扩频通信
1. 香农公式
	在讨论扩频技术之前首先了解一下理论依据，香农定理，在信息论中，香农-哈特利定理陈述了在存在噪声的情况下，信息在特定带宽的通信信道上可以无损传输的最大速率。
	$$C=B*\log_{2}{(1+\frac{S}{N})}$$
	C = 信道容量（bit/s) 即信息在特定带宽下无损传输的最大速率
	B= 信道带宽 （Hz）
	S = 接收信号平均功率 （Watts)
	N = 平均噪声或干扰功率 （Watts)
	S/N = 信噪比(SNR)表示为线性功率比
	由以上公式可知，信息传输的速率与信道带宽以及SNR信噪比成正比，在信噪比固定的情况下可以通过增加带宽来提高信息传播的速率。信息传播距离正比于接收灵敏度和发射功率。接收灵敏度S = 10lg(kTB)+ NF + SNR，即：接收灵敏度 = 10lg(带宽范围内的热噪声功率) + 系统噪声系数 + 解调所需信噪比。
1. 扩频原理
	由香农定理可知，我门可以通过增加带宽来补偿信噪比下降
	在传统的直接序列扩频系统(DSSS)中,发射机的载波相位根据代码序列变化，这个过程通常是通过将要传播的数据与一段扩频码相乘来实现的，也称为（chip sequence)芯片序列，芯片序列以比数据信号快得多的速率产生从而使信号带宽拓宽至原始信道之外。
	![](https://private-warehouse-1317335037.cos.ap-guangzhou.myqcloud.com/Test/Screenshot%202023-05-25%20092940.png)
	在接收端通过本地生成的chip sequence与接收到的信号相乘来恢复云本的信号，接收端的chip sequence必须与发送端的chip sequence相同
	![](https://private-warehouse-1317335037.cos.ap-guangzhou.myqcloud.com/Test/Screenshot%202023-05-25%20093543.png)
	对于直接序列，扩频量取决于“每比特芯片”(chips per bit)的比率——芯片序列与所需数据速率的比率，称为处理增益(Gp)，单位dB
	$$ G_p=10*\log_{2}{\frac{R_c}{R_b}}$$
	$R_c$=chip rate (chips/second)
	$R_b$=bit rate (bits/second)
	DSSS 广泛应用于数据通信，但是在低成本和功耗受限的设备和网络中任然存在挑战。
	
1. 线性调频扩频
		线性调频扩频是在20世纪40年代为雷达应用而开发的。传统上用于许多军事和安全通信应用;在过去的二十年中，这种调制技术在许多数据通信应用中得到了越来越多的采用，因为它具有相对较低的传输功率要求和固有的鲁棒性，不受信道退化机制(如多径、衰落、多普勒和带内干扰)的影响
		
### Lora 扩频
Semtech的LoRa调制解决了与DSSS系统相关的所有问题，提供了低成本，低功耗，但最重要的是传统扩频通信技术的强大替代方案[1]，[2]
在LoRa调制中，频谱的扩展是通过产生频率连续变化的线性调制信号来实现的。这种方法的一个优点是收发器之间的时间和频率偏移是等效的，大大降低了接收机设计的复杂性。  
所需要的数据信号被以一个更高数据速率的chip sequence 调制，再调制在线性调制信号中。即扩频+跳频
所需数据的bit rate ,symbol rate 和 chip rate之间的关系可以表示如下
定义modulation bit rate, $R_b$
$R_b = SF*\frac{1}{(\frac{2^{SF}}{BW})}$   unit : bits/sec
SF = spreading factor (7..12) 扩频因子
BW = modulation bandwidth (Hz) 调制带宽
定义symbol period   $T_s$
$T_s = \frac{2^{SF}}{BW}$   unit : secs
定义symbol rate $R_s$
$R_s=\frac{1}{T_s}=\frac{BW}{2^{SF}}$ unit : symbols/sec
最终我们可以定义 chip rate ,$R_c$
$R_c = R_s * 2^{SF}$   unit: chips/sec
可以看到，这提供了数据表定义:“……每Hz带宽每秒发送一个chip……”，如下所示:
$R_c = BW$
LoRa调制还包括可变纠错方案，以牺牲冗余为代价提高传输信号的鲁棒性
因此我们可以定义数据信号的标称bit rate 为
$R_b = SF *\frac{\frac{4}{4+CR}}{\frac{2^{SF}}{BW}}$
CR = code rate(1..4)
==NOTE 以上符号都是Lora数据手册中的重要参数，但是许多中文翻译把chip翻译成码元 把symbol翻译成码表，有的两者弄混了， 这里我使用原版英文可以更方便看出各个参数之间的关系，翻译成中文失去了原有的意思反而会误导理解，重要参数统一保留英文==

1. lora调制的关键特性
	1. 可扩展带宽
		 LoRa调制具有带宽和频率可扩展性。它可以用于窄带跳频和宽带直接序列应用。与现有的窄带或宽带调制方案不同，LoRa可以很容易地适应任何一种操作模式，只需更改几个简单的配置寄存器
	2. 恒定包络/低功率
		 与FSK类似，LoRa是一种恒定包络调制方案，这意味着相同的低成本和低功耗高效PA级可以重复使用而无需修改。此外，由于与LoRa相关的处理增益，与传统的FSK链路相比，发射机的输出功率可以降低，同时保持相同或更好的链路预算
	3. 高鲁棒性
		1 由于高BT积(BT > 1)和其异步特性，LoRa信号对带内和带外干扰机制都有很强的抵抗能力。由于LoRa符号周期可以比快速跳频系统的典型短持续突发更长，因此它提供了良好的抗脉冲性  
		调幅干扰机制;可以得到典型的90 dB的接收机信道外选择性图和优于20 dB的同信道抑制图。相比之下，相邻和备用信道抑制通常为50 dB, FSK调制的同信道抑制通常为-6 dB
	1. 抗多径/衰落
		线性调制脉冲相对较宽，因此LoRa具有抗多径和衰落的能力，非常适合在两种机制占主导地位的城市和郊区环境中使用
	2. 抗多普勒
		多普勒频移引起LoRa脉冲中的小频移，这在基带信号的时间轴中引入了相对可忽略的频移。这种频率偏移公差降低了对严格公差参考时钟源的要求。LoRa是移动数据通信链路的理想选择，如无线胎压监测系统，收费站和移动标签读取器等驱动应用，以及铁路基础设施的轨道边通信
	1. 远程能力
		在输出功率和吞吐量一定的情况下，LoRa的链路预算高于传统FSK。  
		当与已证明的对干扰和衰落机制的鲁棒性结合使用时，链路预算的这种改进可以很容易地转化为x4，甚至超越范围的增强
	1. 增强网络能力
	2. 测距和定位
		LoRa的一个固有特性是能够线性区分频率和时间误差。LoRa是雷达应用的理想调制，因此非常适合测距和定位应用，如实时定位服务
1. FSK与Lora 敏感度比较
	增加所需信号带宽以在更远的距离上传输无差错数据的原理  (即在噪声与信号比不断增加的情况下)是扩频通信的基本原则，可以通过比较LoRa与FSK收发器的灵敏度来可视化，如下图3所示
	![](https://private-warehouse-1317335037.cos.ap-guangzhou.myqcloud.com/Test/Screenshot%202023-05-25%20105325.png)
	
### 无线通信的注意事项
1. 无线网络
	1. 星状网络拓扑
	2. 网状网络拓扑
2. 多路径传播机制
3. 链路预算
4. 干扰限制链路
5. 知识共生网络
6. 网络试验
### 网络规划示例
1. 容量
2. 链路预算
3. 吞吐量最优化
### 总结
